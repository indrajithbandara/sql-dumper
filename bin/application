#!/usr/bin/env php
<?php

require __DIR__.'/../vendor/autoload.php';

use Symfony\Component\Console\Application;
use Pimple\Container;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use DBDump\Lib\Config;
use DBDump\Database\Connection;
use DBDump\Commands\DumpDatabase;
use DBDump\Commands\RestoreDatabase;

$cliApp = new Application();

$container = new Container();

$container['config'] = function ($container) {
    return new Config($container);
};

$container['connection'] = function ($container) {
    
    $config = $container['config'];
    $connection = new Connection();
    $connection->setHostName($config->get('database.hostname'));
    $connection->setUserName($config->get('database.username'));
    $connection->setDatabase($config->get('database.database'));
    $connection->setPassword($config->get('database.password'));
    
    return $connection;
};

//Attache Commands
$cliApp->add(new DumpDatabase($container));
$cliApp->add(new RestoreDatabase($container));

$cliApp->run();
